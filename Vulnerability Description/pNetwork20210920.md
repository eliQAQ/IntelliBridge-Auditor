2021 年 9 月 19 日 UTC 时间下午 5:20，pNetwork 系统遭到黑客攻击，攻击者对多个 pTokens 桥进行了攻击。然而，攻击仅在 pBTC-on-BSC 跨链桥上成功，该桥被利用，盗取了 277 BTC，损失来自 pBTC-on-BSC 的抵押品。

攻击者首先以  
amount：0，  
userData：0x，  
underlyingAssetRecipient：3LngKgsXQAnm5cLP43PZUGGvMau9uUzhky  
作为输入数据委托调用redeem函数。：
```
function redeem(
    uint256 amount,
    bytes memory userData,
    string memory underlyingAssetRecipient
)
    public
{
    _burn(_msgSender(), amount, userData, "");
    emit Redeem(_msgSender(), amount, underlyingAssetRecipient, userData);
}
```

随后通过攻击合约发送多个
```
Redeem（_msgSender（）， amount， underlyingAssetRecipient， userData） 
```
event事件。

触发的redeem事件都是向攻击者的多个比特币地址转账相同数量1.38个左右的bitcoin，这是跨链攻击中重要的环节。

通过pToken的介绍可知，跨链转账中只是通过查询相关的deposit或redeem事件这种方式来确定btc的转账地址与数量，并没有进行其他的检查！使得黑客利用这一漏洞，在BSC上触发多次redeem事件，窃取大量的BTC。  
（由于 Rust 代码中的一个漏洞，负责提取这些日志事件的部分，合法的和故障的日志都被提取并错误地处理。）

## 事件地址
<https://bscscan.com/address/0x2bf5693dd3a5cea1139c4510fdce120cf042c934>

## 参考资料
<https://www.mytokencap.com/news/336205/>  
<https://learnblockchain.cn/article/12433>