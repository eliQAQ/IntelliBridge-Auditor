LIFI20220320: 合约涉及call函数但未检查call的数据，攻击者可以借此转账授权给该合约的用户的代币。  
LIFI20240716：同LIFI20220320  
Multichain20220118：未检查输入合约类型是否符合AnyswapV1ERC20的标准和permit的返回值，导致跳过了permit函数，将恶意合约填写的标的资产转给了攻击者。  
Nerve20211115：swap未计算虚拟价格导致LP被低估，攻击者通过兑换更多的LP然后再换回原资产获利。  
Nomad20220801：合约升级修改了process函数但初始化函数未修改，导致confirmAt[0]=1，使得任意消息都能通过梅克尔树的检查。  
PolyNetwork20210810：_executeCrossChainTx中_toContract.call未作严格检查且_toContract中有修改owner的函数（external）, 攻击者使用hash碰撞出和该函数前4个字节相同的_method并传入_args修改owner为自己然后就能unlock代币转给自己了。  
QBridge20220128：合约中为标准代币和原生代币制作了两个不同的函数（deposit和depositETH）但使用的tokenAddress池子是相同的且deposit中无需直接支付代币，由于原生代币是0地址所以充值空过然后触发了充值事件导致目标链上用户凭空获取了代币。  
Rubic20221225：项目方错误地将 USDC Token 地址设置为 router 地址，且对于call的数据没有检查，导致可以指定_data为transferFrom转出了授权给该代币地址的用户的代币。  
SocketGateway20240117： 新router的 WETH 与 ETH 的转换函数中当amount为0时转换结果检查会一定通过，此时用户可以指定call的swapExtraData调用token的transferfrom函数将授权的代币转给自己。   
Synapse20211106：同Nerve20211115
XBridge20240424：listToken函数（标记跨链代币的对应关系）可以被外部调用且当传入的地址_baseToken==_correspondingToken相同时可以认为用户是代币的主人，尽管检查了存在性但是chain可以设置任意值，只要不重复即可，转账时token为显示输入，只检查owner，导致认为攻击者是token的owner，攻击者转出代币。   
chainswap20210711：该跨链桥检查签名有效性的函数基本上是摆设，只检查了签名的完整性但是没有检查签名的有效性，默认签名是正确的，没有处理不存在的情况，并且添加配额时使用到了签名地址的上次签名时间，同样没有处理不存在的情况，导致会给一个乘时间戳的配额给该地址，使得任意签名都能拥有极大的配额。因此用户自己随便签个名就能通过检验，随意调用receive函数取钱。此外事件发生前管理者还将需要的验证数量设定为了1，更加便于攻击者攻击了。  
meterpassport20220206：类似QBridge20220128  
pNetwork20210920：链下负责日志的代码法不管合法的还是故障的日志都被提取并错误地处理，导致伪造事件骗钱。   
thorchain20210723：returnVaultAssets函数错误地能被外部调用，攻击者指定asgard为恶意合约并编写了fallback函数，在fallback函数中触发假的Deposit事件，returnVaultAssets调用asgard汇款触发fallback发出虚假的事件，该事件memo参数是异常的，链下获取后认为是错误事件执行了退款的操作，另外输入的router是0地址，一些router上的操作没有检查返回值也直接过去了。


此外，并没有找到Multichain20230215和QANXBridge20220518的信息，前者倒是有一个2023年7月的，但是认为是私钥泄露，后者也只找到一篇报道，也是私钥泄露。


## 漏洞分类

(1) 传输过程中可以伪造事件  

Nomad20220801：由于初始化问题导致任意消息都能通过梅克尔树检查，可以伪造事件。  
QBridge20220128：通过充值空过触发虚假充值事件，导致目标链上凭空获取代币。  
thorchain20210723：通过恶意合约的fallback函数伪造Deposit事件，触发错误的退款操作。  
pNetwork20210920：链下日志处理错误，伪造事件骗钱。  
chainswap20210711：签名验证无效，攻击者可以伪造签名并通过事件取钱。  
meterpassport20220206：类似QBridge20220128，通过伪造事件凭空获取代币。   

(2) 传输过程中操纵事件中的参数

LIFI20220320 & LIFI20240716：未检查call的数据，攻击者可以操纵参数转账授权代币。  
Multichain20220118：未检查合约类型和permit返回值，操纵参数跳过permit函数。  
Rubic20221225：未检查call的数据，操纵参数转出授权代币。  
SocketGateway20240117：当amount为0时，操纵swapExtraData调用transferfrom转出代币。   

(3) 待分类事件

PolyNetwork20210810：通过hash碰撞伪造方法调用，修改owner并解锁代币。  
Nerve20211115 & Synapse20211106：未计算虚拟价格，操纵兑换参数低估LP获利。  
XBridge20240424：操纵listToken参数，伪造代币对应关系获取owner身份并转出代币。 

## 按产生事件数量是否与预期相符进行分类

（1） 相符  

Nomad20220801：仅仅是跳过了检查   
chainswap20210711： 验证无效  
Multichain20220118： 伪造恶意合约获取他人资产，但事件数量是合理的 
Nerve20211115 & Synapse20211106： 虚拟价格计算错误  
XBridge20240424：伪造身份

（2） 不相符  

QBridge20220128： 缺少充值事件  
thorchain20210723： 假充值伪造事件，缺少充值事件  
pNetwork20210920： 伪造事件  
meterpassport20220206： 同QBridge20220128  
LIFI20220320 & LIFI20240716：外部恶意调用产生意外转账事件  
Rubic20221225：恶意外部调用  
SocketGateway20240117：恶意外部调用 
PolyNetwork20210810：恶意调用  

