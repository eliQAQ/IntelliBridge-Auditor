## 攻击流程

1.攻击者（0xBDf38B74）部署攻击合约（0xDDb19a1B），随后调用该合约中的 Wooooo 函数。
![](https://miro.medium.com/v2/resize:fit:1100/format:webp/0*_fT09zCalCuEDwBI.png)
2.攻击合约在执行过程中调用了目标合约（0x79cdFd7B）中的 0x0031b016 函数。
![](https://miro.medium.com/v2/resize:fit:1100/format:webp/0*5V4ZLfTzIFNSrSJF.png)
3.该函数直接将用户的 USDT 代币转移至攻击合约。
![](https://miro.medium.com/v2/resize:fit:1100/format:webp/0*GT1aXALfof7ZrzJ_.png)
## 漏洞分析

被攻击的目标合约（0x79cdFd7B）是 HashFlow 的一份已弃用合约，该合约于去年 5 月就停止使用，且未开源。通过反向工程分析可以看出，该合约的功能为从 from 地址向 to 地址转移代币。

据推测，在 2022 年 5 月之前，很多用户曾向该合约授予了代币授权，但合约弃用后，这些授权并未被用户主动撤销。由于合约弃用后的逻辑限制存在问题，攻击者得以利用该合约中的函数，非法转移用户资产。
![](https://miro.medium.com/v2/resize:fit:1100/format:webp/0*kCJQj8rZlpyHk5Tq.png)

## 参考链接

https://medium.com/@sharkteam/sharkteam-analysis-of-the-hashflow-attack-incident-8d062b30074f
