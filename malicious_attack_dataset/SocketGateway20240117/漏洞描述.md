该漏洞为2024 年 1 月 16 日发生在Socket Tech的Socket Gateway合约上面的攻击，原因在于Socket合约管理员在三天前执行了addRoute命令，在系统中加入了一条新路由，但新添加的路由地址（WrappedTokenSwapperImpl\src\swap\wrappedTokenSwapper\swapWrappedImpl.sol）内的performAction函数中，出现了一个关键漏洞：用户在无需验证的情况下，直接在.call() 中通过swapExtraData调用外部数据，这意味着攻击者可以执行任意恶意函数，且不受任何权限制约。

`![漏洞代码](https://img.picui.cn/free/2025/04/13/67fb8ea7c5f90.png)`

代码功能主要是用于用户 WETH 与 ETH 的转换，虽然函数中并没有对fromToken与toToken进行任何检查限制，但是除了传入WETH地址，其他ERC20地址都将导致余额检查失败，从而无法伪造这两个参数，间接将token地址限制为WETH。但虽然对token地址有所限制，但是该函数还存在一个问题，便是未对amount进行限制，如果调用者传入的amount为0，则函数的检查条件将恒通过，并不需要调用WETH的deposit与withdraw函数。此时便可以在call中注入异常的数据，从而达到攻击的目的。

`![转入金额为0即可通过检查](https://img.picui.cn/free/2025/04/13/67fb8fdc15813.png)`

因此攻击者的攻击流程为：
1. 查询不同地址的代币（WETH、USDT、WBTC、DAI、MATIC）余额和对于Socket Getway的批准额度。
2. 控制swapExtraData参数操纵calldata调用token的transferfrom函数将受批准的代币转移给自己。
`(bool success, ) = fromToken.call(swapExtraData);`
3. 重复以上流程。 
